<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE TEI.2 SYSTEM "tei_bawe.dtd"><TEI.2 id="_0311j" n="version 1.0"><teiHeader><fileDesc><titleStmt><title>Monte Carlo Simulation: Finding the Minimum Energy Configuration of Lennard-Jones Atomic Clusters</title></titleStmt><extent/><publicationStmt><distributor>British Academic Written English (BAWE) corpus</distributor><availability><p>The British Academic Written English (BAWE) corpus was developed at the Universities of Warwick, Reading and Oxford Brookes, under the directorship of Hilary Nesi and Sheena Gardner (formerly of the Centre for Applied Linguistics [previously called CELTE], Warwick), Paul Thompson (Department of Applied Linguistics, Reading) and Paul Wickens (Westminster Institute of Education, Oxford Brookes), with funding from the ESRC. Subject to the rights of the these institutions in the BAWE corpus, and pursuant to the ESRC agreement, the BAWE corpus is available to researchers for research purposes PROVIDED THAT the following conditions are met:</p><p>1. The corpus files are not distributed in either their original form or in modified form.</p><p>2. The texts are used for research purposes only; they should not be reproduced in teaching materials.</p><p>3. The texts are not reproduced in full for a wider audience/readership, although researchers are free to quote short passages of text (up to 200 running words from any given text).</p><p>4. The BAWE corpus developers (contact: Hilary Nesi) are informed of all projects, dissertations, theses, presentations or publications arising from analysis of the corpus.</p><p>5. Researchers acknowledge their use of the corpus using the following form of words: "The data in this study come from the British Academic Written English (BAWE) corpus, which was developed at the Universities of Warwick, Reading and Oxford Brookes under the directorship of Hilary Nesi and Sheena Gardner (formerly of the Centre for Applied Linguistics [previously called CELTE], Warwick), Paul Thompson (Department of Applied Linguistics, Reading) and Paul Wickens (Westminster Institute of Education, Oxford Brookes), with funding from the ESRC (RES-000-23-0800)."</p></availability></publicationStmt><notesStmt><note resp="British Academic Written English (BAWE) corpus project">The document has a title page which contains:
document title
title part</note><note resp="British Academic Written English (BAWE) corpus project">deleted: footer: student name, page numbers, date</note><note resp="British Academic Written English (BAWE) corpus project">Evaluated as candidate compound assignment. Assigned to S4: set of tasks/questions/exercises: non-compound</note></notesStmt><sourceDesc><p n="level">4</p><p n="date">2005-11</p><p n="module title">High Performance Computing in Physics</p><p n="module code">PX452</p><p n="genre family">Methodology recount</p><p n="discipline">Physics</p><p n="disciplinary group">PS</p><p n="grade">D</p><p n="number of authors">1</p><p n="number of words">1734</p><p n="number of s-units">74</p><p n="number of p">29</p><p n="number of tables">0</p><p n="number of figures">6</p><p n="number of block quotes">0</p><p n="number of formulae">10</p><p n="number of lists">0</p><p n="number of paragraphs formatted like lists">0</p><p n="abstract present">no abstract</p><p n="average words per s-unit">23.4</p><p n="average s-units per p">2.6</p><p n="macrotype of assignment">complex but non-compound assignment (see notesStmt for details)</p></sourceDesc></fileDesc><encodingDesc><p>TEI P4 (documented in: BAWE.documentation.pdf)</p></encodingDesc><profileDesc><particDesc><person><p n="gender">m</p><p n="year of birth">1984</p><p n="first language">English</p><p n="education">UKA</p><p n="course">MPhys</p><p n="student ID">0311</p></person></particDesc></profileDesc></teiHeader><text><front><titlePage><titlePart>PX425 High Performance Computing in Physics 2005</titlePart><docTitle><titlePart rend="bold">Monte Carlo Simulation: Finding the Minimum Energy Configuration of Lennard-Jones Atomic Clusters</titlePart></docTitle><titlePart>By <name type="student name"/> (<name type="student ID"/>)</titlePart><titlePart/></titlePage></front><body><div1 type="section"><head rend="bold">Introduction</head><p n="p1.29"><s n="s1.4;p1.29">This module had four assessed assignments, each completed fortnightly. </s><s n="s2.4;p1.29">The main programming language for me was Fortran 95. </s><s n="s3.4;p1.29">The programs were compiled using either the 'IntelÂ® Fortran Compiler' or where MPI was required, the 'Portland Group PGI Compiler'. </s><s n="s4.4;p1.29">For assignment 4, Python 2.4 was used to write the GUI to interface to the compiled Fortran code. </s></p><p n="p2.29"><s n="s1.3;p2.29">The intended outcome of the assignments was to find the minimum energy configuration of a set number of 'atoms' experiencing a mutual Lennard-Jones interaction of form <formula notation="" id="BAWE_0311j-form.001"/>. </s><s n="s2.3;p2.29">This was achieved using Monte Carlo methods to pseudorandomly shift the position of each atom and see if the energy was acceptable according to a Boltzmann distribution, with energy proportional to <formula notation="" id="BAWE_0311j-form.002"/>. </s><s n="s3.3;p2.29">From this you can understand that the temperature of the system, <hi rend="italic">T</hi>, is an important parameter in that it has a large effect on the outcome (and energy) of the configuration. </s></p></div1><div1 type="section"><head rend="bold">Assignment 1</head><p n="p3.29"><s n="s1.3;p3.29">The program picks four random positions for the atoms inside a suitably sized sphere. </s><s n="s2.3;p3.29">The energy of this state is calculated using two loops to find the distance between distinct pairs of atoms and putting this distance into the Lennard-Jones potential model. </s><s n="s3.3;p3.29">This energy was summed over all distinct bonds. </s></p><p n="p4.29"><s n="s1.4;p4.29">Every atom (four in this case) is in turn moved slightly (within <formula notation="" id="BAWE_0311j-form.003"/> of its original location) in a random direction and the energy recalculated for this new state. </s><s n="s2.4;p4.29">If the energy is favourable then the change is accepted, else the atom is placed back. </s><s n="s3.4;p4.29">At the end, the program returns the final energy per atom along with how many moves were accepted. </s><s n="s4.4;p4.29">The final configuration is also written to disk in xyz format, so as to be read by external programs. </s></p><p n="p5.29"><s n="s1.2;p5.29">For these 4 atoms, looping 500,000 times with <formula notation="" id="BAWE_0311j-form.004"/> and <formula notation="" id="BAWE_0311j-form.005"/>the average acceptance ratio was 78% and average final energy was -0.72 per atom. </s><s n="s2.2;p5.29">This energy is normalised so that the minimum energy a 'bond' between two atoms can have is -1. </s></p><p n="p6.29"><s n="s1.1;p6.29">The computing facilities (2.6 GHz Pentium4 Xeon with 2 GB of memory) were provided by the Centre for Scientific Computing of the University of <name type="university"/>. </s></p></div1><div1 type="section"><head rend="bold">Assignment 2</head><p n="p7.29"><s n="s1.3;p7.29">The program was modified to output the energy per atom averaged over the last 90% of the moves loop as well as just returning the energy of the final configuration. </s><s n="s2.3;p7.29">Also the energy change caused by the shifted atom was calculated more efficiently by only summing over the bonds that actually moved. </s><s n="s3.3;p7.29">These changes were tested and shown to give compatible results with assignment 1. </s></p><p n="p8.29"><s n="s1.3;p8.29">OpenMP was then added to the code. </s><s n="s2.3;p8.29">The two DO loops that calculate the energy (the full and efficient versions) were parallelized with a static schedule. </s><s n="s3.3;p8.29">In tests on multi-processor machines this schedule was the quickest followed by guided and finally dynamic. </s></p><figure id="BAWE_0311j-fig.001"><head><hi rend="bold">Figure 1.</hi> The actual runtime of my program as a function of how many atoms there are in the cluster. Blue is a serial schedule, Green is parallelized with a (<hi rend="italic">Static</hi> ,1) schedule andRed is parallelized with a <hi rend="italic">Guided</hi> schedule.These data were all recorded on the same two-processor machine, a 2.6 GHz Pentium4 Xeon with 2 GB of memory. The fitting curves are 2 <hi rend="sup">nd</hi> order polynomials.</head></figure><p n="p9.29"><s n="s1.1;p9.29">Further testing showed that the Parallelized (<hi rend="italic">Static,</hi> 1) schedule overtook the Serial code for atom amounts <hi rend="italic">n</hi>>37. </s></p><p n="p10.29"><s n="s1.3;p10.29">Simulated annealing was introduced to the code. </s><s n="s2.3;p10.29">The 'temperature' variable was reduced over 50 iterations from 1 to 0.00001 according to the equation <formula notation="" id="BAWE_0311j-form.006"/>, where <hi rend="italic">m</hi> is the iteration number. </s><s n="s3.3;p10.29">Correspondingly, the maximum small change each atom could be shifted by was calculated to be <formula notation="" id="BAWE_0311j-form.007"/>. </s></p><p n="p11.29"><s n="s1.2;p11.29">Each iteration ran the entire Monte Carlo procedure, taking in the configuration that the last iteration arrived at. </s><s n="s2.2;p11.29">The temperature, value of <formula notation="" id="BAWE_0311j-form.008"/>, acceptance rate, average energy for 90% of the run and final energy were printed. </s></p><p n="p12.29"><s n="s1.3;p12.29">By the end of this annealing procedure the atoms were in a minimum energy state. </s><s n="s2.3;p12.29">For <hi rend="italic">n</hi>=4, the atoms were in a tetrahedral shape with atomic spacing ~1.122, the length (<formula notation="" id="BAWE_0311j-form.009"/>) that corresponds to the minimum potential -1. </s><s n="s3.3;p12.29">The average energy was -1.499993 per atom. </s></p><p n="p13.29"><s n="s1.3;p13.29">For <hi rend="italic">n</hi>=13, the atoms formed an icosahedron with a single atom at the centre of the shape. </s><s n="s2.3;p13.29">The average energy was -3.409741 per atom. </s><s n="s3.3;p13.29">The results were reproducible. </s></p><figure id="BAWE_0311j-pic.002"><head><hi rend="bold">Figure 2.</hi> The icosahedron with an atom at the centre is a global energy minimum for the 13 atom Lennard-Jones cluster.</head></figure><figure id="BAWE_0311j-fig.002"><head><hi rend="bold">Figure 3.</hi> With temperature plotted inversely this semi-log plot shows the energies converge to a stable minimum as the temperature is decreased for 4 atoms (red) and 13 atoms (green). The fitting curves are linear.</head></figure><p n="p14.29"><s n="s1.1;p14.29">The 13-atom simulated annealing run was performed on an SGI Altix supercomputer, a large shared memory machine with 56 x 1.6 GHz Intel Itanium2 processors and 112 GB of RAM. The computing facilities were provided by the Centre for Scientific Computing of the University of <name type="university"/> with support from Science Research Investment Fund grant (grant code TBA). </s></p></div1><div1 type="section"><head rend="bold">Assignment 3</head><p n="p15.29"><s n="s1.5;p15.29">The program was adapted to use MPI libraries instead of the OpenMP compiler directives. </s><s n="s2.5;p15.29">All the OpenMP lines were stripped out. </s><s n="s3.5;p15.29">The seed value for the random number generator was changed to be chosen dependent on processor rank, so each process has a different stream of pseudorandom numbers. </s><s n="s4.5;p15.29">The loop iterating the temperature down (simulated annealing) was removed; instead each process was given a different temperature based on its rank. </s><s n="s5.5;p15.29">Changes were made so that only the master process writes to the output file. </s></p><p n="p16.29"><s n="s1.3;p16.29">Every 10 (or whatever the <hi rend="italic">exchange_interval</hi> variable is set to in the program) moves, neighbouring processes attempt to swap atomic configurations depending on energy considerations of the two systems. </s><s n="s2.3;p16.29">Counters take note of successful swaps. </s><s n="s3.3;p16.29">This is called parallel tempering. </s></p><p n="p17.29"><s n="s1.3;p17.29">There are two types of process - even ranked and odd ranked. </s><s n="s2.3;p17.29">The even ranked processes are the ones that make the decisions about swapping and send their decision to the correct odd ranked process (either above or below). </s><s n="s3.3;p17.29">If swapping is decided upon then the entire atomic configuration is passed between processes using the MPI_Send and MPI_Recv function calls. </s></p><p n="p18.29"><s n="s1.3;p18.29">After checking the 13-atom test gave the right energy, in my case -3.396695 per atom, I increased the number of atoms to 38 and the moves to 5 million. </s><s n="s2.3;p18.29">This program was compiled and run on Starling giving the average energy per atom to be -4.563743 for temperature 0.01. </s><s n="s3.3;p18.29">(Starling consists of 16 x 2.6GHz Opteron nodes each with 8 GB of memory and interconnected by Myrinet 2000 revision "F", my MPI program ran on 8 of these nodes.) </s></p><figure id="BAWE_0311j-fig.003"><head><hi rend="bold">Figure 4.</hi> With temperature plotted inversely this semi-log plot shows the energies converge to a stable minimum as the temperature is decreased for 4 atoms (red) and 13 atoms (green). Added to this graph over figure 3 are the curves obtains from the parallel tempering program for 13 atoms (black) and 38 atoms (blue). The fitting curves are linear.</head></figure><p n="p19.29"><s n="s1.2;p19.29">For a 38 atom Lennard-Jones cluster the global minimum energy configuration is that of a truncated octahedron, having a simulated energy of -173.928427 in total, compared to my slightly higher -173.422234 total energy. </s><s n="s2.2;p19.29">My 38 atom cluster has the octahedral symmetry of this global minimum. </s></p><figure id="BAWE_0311j-pic.003"><head><hi rend="bold">Figure 5.</hi> The atomic configuration of my 38 atom Lennard-Jones cluster as a result of parallel tempering. The shape is a truncated octahedron.</head></figure><p n="p20.29"><s n="s1.1;p20.29">There exists, however, another minimum nearby based on icosahedral symmetry with a total energy of -173.252378, which is higher than the energy of my cluster. </s></p><figure id="BAWE_0311j-pic.004"><head><hi rend="bold">Figure 6.</hi> A diamond-shaped 38 atom Lennard-Jones cluster with icosahedral symmetry.</head></figure></div1><div1 type="section"><head rend="bold">Assignment 4</head><p n="p21.29"><s n="s1.2;p21.29">This assignment was mainly written in Python, using Tkinter to create a Graphical User Interface (GUI). </s><s n="s2.2;p21.29">Although completed in several stages, the text below records just the final outcome for clarity. </s></p><figure id="BAWE_0311j-pic.005"><head><hi rend="bold">Figure 7.</hi> My Tkinter-face as shown on a Linux computer.</head></figure><p n="p22.29"><s n="s1.3;p22.29">All the MPI calls were removed from the program, so the Monte Carlo routine would run at just one temperature, determined by the user and set by the GUI. The number of moves was reduced to 5000 to speed up the computation. </s><s n="s2.3;p22.29">The number of atoms was fixed at 13 in both the Fortran and Python code. </s><s n="s3.3;p22.29">The lines that created a random configuration and outputted to a file were removed in the Fortran code, it was now entirely dependent on the Python interface for Input-Output. </s></p><p n="p23.29"><s n="s1.2;p23.29">The Fortran program was changed to a subroutine that takes in a 13 by 3 array containing the xyz atomic position for each atom, and the temperature of the system. </s><s n="s2.2;p23.29">The subroutine returns the processed 13 by 3 array back to the Python interface. </s></p><p n="p24.29"><s n="s1.2;p24.29">In order to get the Fortran program to interface with Python a program to wrap the subroutine, called F2PY, was used. </s><s n="s2.2;p24.29">This allowed Python to '<hi rend="italic">import</hi>' the Fortran code as if it was a regular module. </s></p><p n="p25.29"><s n="s1.3;p25.29">The Python code imports several modules including Numeric and Scientific, which provide visualisation of the atomic cluster using a VRML2 viewer. </s><s n="s2.3;p25.29">My interface allows the user to view the contents of a '<hi rend="italic">.xyz</hi>' file or view the cluster directly from the buffer which doesn't require writing to disk. </s><s n="s3.3;p25.29">Also, the user can view the contents of a file as ASCII or see the array in the buffer likewise. </s></p><p n="p26.29"><s n="s1.1;p26.29">An important function of the interface is the ability to create random positions of atoms, since this functionality was now stripped from the Fortran code. </s></p><figure id="BAWE_0311j-pic.006"><head><hi rend="bold">Figure 8.</hi> A randomly generated configuration of 13 atoms.</head></figure><p n="p27.29"><s n="s1.2;p27.29">The temperature is also controlled through the interface, so the user can view the configuration, change the temperature, run the Monte Carlo procedure, and view again. </s><s n="s2.2;p27.29">Once the user is satisfied they can choose to write to disk, as all the viewing and resubmitting arrays is done in memory. </s></p><p n="p28.29"><s n="s1.3;p28.29">The user can manually anneal a random cluster by reducing the temperature between each run using the slider on the interface. </s><s n="s2.3;p28.29">Alternatively, an '<hi rend="italic">Anneal</hi>' button has been provided that linearly reduces the temperature from 0.5 to 0.01 over 50 iterations. </s><s n="s3.3;p28.29">This robustly takes a random configuration to the icosahedral symmetry global energy minimum. </s></p><p n="p29.29"><s n="s1.3;p29.29">Although not necessary, to aid visualisation, the Python code calculates and draws in the bonds between the atoms with colour denoting length of bond. </s><s n="s2.3;p29.29">Although the program can only internally handle 13 atom clusters, the '<hi rend="italic">display file</hi>' routine is capable of displaying any number of atoms in a file of xyz format. </s><s n="s3.3;p29.29">Thus for clusters containing more than 13 atoms, bond lengths over 2 (corresponding to <formula notation="" id="BAWE_0311j-form.010"/>) are not drawn. </s></p></div1></body><back/></text></TEI.2>
